## 问题分析

1. **文本框高度过大**：
   - charsPerLine = (400-32)/8 = 46 字符/行（过多）
   - 行高 26px + 内边距 24px + 标题额外 8px（过大）
   - 导致计算高度比实际内容高很多

2. **公式框没有设置宽度**：
   - 只设置了高度，没设置宽度
   - 应该使用 settings.formulaNodeWidth

## 修复方案

### 1. 优化 calculateTextNodeHeight 方法
- avgCharWidth: 8px → 9px（减少每行字符数）
- lineHeight: 26px → 22px（减小行高）
- verticalPadding: 24px → 16px（减小内边距）
- 移除 headerExtraHeight（标题不再额外加高）
- minHeight: 80px → 60px（减小最小高度）

### 2. 修复 adjustAllTextNodeHeights 方法
- 公式节点添加宽度设置：node.width = this.settings.formulaNodeWidth || 400

## 修改文件
- src/canvas/canvas-manager.ts

请确认这个方案。